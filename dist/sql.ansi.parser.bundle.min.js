function iterateRegex(n,t,i){for(var u=[],r=n.exec(t);r!=null;)i(n,t,r),u.push(r),r=n.exec(t)}Object.deepExtend=function(n,t){for(var i in t)t[i]&&t[i].constructor&&t[i].constructor===Object?(n[i]=n[i]||{},arguments.callee(n[i],t[i])):n[i]=t[i];return n};String.prototype.replaceAll=function(n,t){for(var i=this.toString().replace(n,t);i.indexOf(n)!=-1;)i=i.replace(n,t);return i};String.prototype.trim=function(){return this.replace(/^\s+|\s+$/gm,"")};String.isNullOrWhiteSpace=function(n){return n==null||n.toString().trim()==""};var sql={ansi:{parser:{REGEXES:{COMMENT:/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(\/\/.*)/g,DATABASE_START_POINT:/(((CREATE)|(ALTER)) {1,}(DATABASE)|(USE)) {1,}([a-zA-Z0-9]+)/igm,CREATE_TABLE_HEADER:{EXPRESSION:/(CREATE|ALTER) {1,}(TABLE) {1,}(((\[[^\]]+\]|[a-zA-Z0-9_]+)\.(\[[^\]]+\]|[a-zA-Z0-9_]+))|(\[[^\]]+\]|[a-zA-Z0-9_]+))[ ]{0,}\([ ]{0,}/igm,CAPTURES_INDEXES:{COMMAND_TYPE:1,SCHEMA_NAME:5,TABLE_NAME:6,TABLE_NAME_ALTERNATIVE:7}},CONSTRAINT_INLINE:/CONSTRAINT[ ]{0,}(\[{0,}[^\[]+\]{0,})(.+(CLUSTERED)?)?[ ]{0,}\(([^\)]+)\)+/igm,CONSTRAINT_PRIMARY_KEY_HEADER:{EXPRESSION:/CONSTRAINT +\[?([^\]]+)\]? {0,}(PRIMARY +KEY)[^\(]+(\([^\)]+\))/img,CAPTURES_INDEXES:{CONSTRANTI_NAME:1,COLUMNS_SPEC:3},FIELDS_DEF:{EXPRESSION:/ {0,},? {0,}\[?([^\]]+)\]? +(ASC|DESC)/img,CAPTURES_INDEXES:{FIELD_NAME:1,SORT_TYPE:2}}},CONSTRAINT_FOREIGN_KEY_HEADER:{EXPRESSION:/CONSTRAINT +\[?([^\]]+)\]? {0,}(FOREIGN {0,}KEY)[^\(]+\(/img,CONSTRANTI_NAME:1},CONSTRAINT_FOREIGN_KEY_HEADER:{EXPRESSION:/CONSTRAINT +\[?([^\]]+)\]? {0,}(FOREIGN {0,}KEY)[^\(]+\(/img,CONSTRANTI_NAME:1},TABLE_COLUMN:{EXPRESSION:/(\[[^\]]+\]|[a-zA-Z0-9_]+)[ ]+((\[[^\]]+\]|[a-zA-Z0-9_]+)([ ]{0,}\([ ]{0,}(([0-9]+)([ ]{0,},[ ]{0,}([0-9]))?)[ ]{0,}\))?)([ ]{1,}(PRIMARY[ ]{1,}KEY([ ]{1,}ASC|[ ]{1,}DESC)))?([ ]{1,}(IDENTITY([ ]{0,}\([ ]{0,}([0-9]+)[ ]{0,},[ ]{0,}([0-9]+)[ ]{0,}\))))?([ ]{1,}(NOT[ ]{1,})?NULL)?[ ]{0,}[,]{0,}[ ]{0,}/igm,CAPTURES_INDEXES:{NAME:1,DATA_TYPE:3,PRECISION:6,SCALE:8,IS_IDENTITY:13,IDENTITY_SEED:15,IDENTITY_STEP:16,IS_PRIMARY:10,IS_NOT_NULL:18}}}},models:{}}};sql.ansi.models.column=function(n){this.name="";this.isPrimary=!1;this.table=null;this.type="";this.precision=0;this.scale=0;this.isNullable=!0;this.isAutoIncrement=!1;this.increment={seed:0,step:1};Object.deepExtend(this,n||{})};sql.ansi.models.table=function(n){this.name="";this.schema="";this.database=null;this.columns=[];this.indexes=[];this.foregnKeys=[];Object.deepExtend(this,n||{})};sql.ansi.models.primaryKey=function(n){this.name="";this.colunms=[];Object.deepExtend(this,n||{})};sql.ansi.models.SORT={ASC:"ASC",DESC:"DESC"};sql.ansi.models.columnIndexSpec=function(n){this.name="";this.sort=sql.ansi.models.SORT.ASC;Object.deepExtend(this,n||{})};sql.ansi.parser.databaseScript=function(){iterateRegex(sql.ansi.parser.REGEXES.DATABASE_START_POINT,function(){})};sql.ansi.parser.columnScript=function(n){var t=[];return iterateRegex(sql.ansi.parser.REGEXES.TABLE_COLUMN.EXPRESSION,n,function(n,i,r){var u=r[0],f=new sql.ansi.models.column({name:r[sql.ansi.parser.REGEXES.TABLE_COLUMN.CAPTURES_INDEXES.NAME],type:r[sql.ansi.parser.REGEXES.TABLE_COLUMN.CAPTURES_INDEXES.DATA_TYPE],precision:r[sql.ansi.parser.REGEXES.TABLE_COLUMN.CAPTURES_INDEXES.PRECISION],scale:r[sql.ansi.parser.REGEXES.TABLE_COLUMN.CAPTURES_INDEXES.SCALE],isPrimary:!!r[sql.ansi.parser.REGEXES.TABLE_COLUMN.CAPTURES_INDEXES.IS_PRIMARY],isAutoIncrement:!!r[sql.ansi.parser.REGEXES.TABLE_COLUMN.CAPTURES_INDEXES.IS_IDENTITY],increment:{seed:r[sql.ansi.parser.REGEXES.TABLE_COLUMN.CAPTURES_INDEXES.IDENTITY_SEED],step:r[sql.ansi.parser.REGEXES.TABLE_COLUMN.CAPTURES_INDEXES.IDENTITY_STEP]},isNullable:!!r[sql.ansi.parser.REGEXES.TABLE_COLUMN.CAPTURES_INDEXES.IS_NOT_NULL],src:u});t.push(f)}),t};sql.ansi.parser.tableScript=function(n){for(var r=[],t=n.toString(),u=this,i=u.REGEXES;i.COMMENT.test(t);)t=t.replace(i.COMMENT,"");return t=t.replaceAll("\t"," ").replaceAll("\r"," ").replaceAll("\n"," "),iterateRegex(i.CREATE_TABLE_HEADER.EXPRESSION,t,function(n,u,f){var e=t.substring(f.index,t.indexOfCloser(f.index+f[0].length,"(",")")+1),o=new sql.ansi.models.table({src:e,schema:f[i.CREATE_TABLE_HEADER.CAPTURES_INDEXES.SCHEMA_NAME],name:f[i.CREATE_TABLE_HEADER.CAPTURES_INDEXES.TABLE_NAME]||f[i.CREATE_TABLE_HEADER.CAPTURES_INDEXES.TABLE_NAME_ALTERNATIVE]}),s;e=e.substring(f[0].length);e=e.toString().replaceAll(i.CONSTRAINT_PRIMARY_KEY_HEADER.EXPRESSION,function(n){o.primaryKey=new sql.ansi.models.primaryKey;n.replaceAll(i.CONSTRAINT_PRIMARY_KEY_HEADER.FIELDS_DEF.EXPRESSION,function(){})});o.columns=sql.ansi.parser.columnScript(e);for(s in o.columns)s.table=o;r.push(o)}),r};String.prototype.indexOfCloser=function(n,t,i){for(var u=1,r=n;r<this.length;r++){if(this[r]==t){u++;continue}if(this[r]==i){if(u--,u==0)return r;continue}}};